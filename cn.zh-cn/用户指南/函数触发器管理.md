# 函数触发器管理<a name="functiongraph_01_0301"></a>

函数创建以后，通过Trigger触发，自行调度所需资源及环境，实现预期功能。

## 前提条件<a name="section11491036618"></a>

1.  创建SMN触发器之前，需要开启消息通知服务，并且在消息通知服务中创建主题。创建过程请参考[创建消息主题](https://support.huaweicloud.com/usermanual-smn/zh-cn_topic_0043961401.html)。
2.  创建DMS触发器之前，需要开启分布式消息服务，并且在分布式消息服务中创建消息队列，在消息队列创建消费组。创建过程请参考[创建队列](https://support.huaweicloud.com/usermanual-dms/zh-cn_topic_0034678324.html)、[创建消费组](https://support.huaweicloud.com/usermanual-dms/zh-cn_topic_0034678327.html)。
3.  创建APIG触发器之前，需要开通API网关服务，并在API网关服务中创建分组。创建过程请参考[创建API分组](https://support.huaweicloud.com/usermanual-apig/apig-zh-ug-180307015.html)。
4.  创建OBS触发器之前，需要开通对象存储服务，并且在对象存储服务中创建存储桶。创建过程请参考[创建存储桶](https://support.huaweicloud.com/usermanual-obs/zh-cn_topic_0045829050.html)。
5.  创建DIS触发器之前，需要开通数据接入服务，并且在数据接入服务中创建接入通道。创建过程请参考[创建DIS通道](https://support.huaweicloud.com/usermanual-dis/zh-cn_topic_0034903799.html)。
6.  创建LTS触发器之前，需要开通云日志服务，并且在云日志服务中创建日志组和日志主题，并配置Agent。请参考[创建日志组](https://support.huaweicloud.com/qs-lts/zh-cn_topic_0067564152.html)、[创建日志主题](https://support.huaweicloud.com/qs-lts/zh-cn_topic_0067564153.html)、[Agent配置](https://support.huaweicloud.com/qs-lts/zh-cn_topic_0078543180.html)。
7.  创建CTS触发器之前，需要开通云审计服务，并且添加云审计服务和操作，服务及操作详情可参考[支持审计的服务及详细操作列表](https://support.huaweicloud.com/usermanual-cts/zh-cn_topic_0100236046.html)。

## 创建触发器<a name="section6149185355015"></a>

1.  用户登录FunctionGraph，进入“函数”界面。
2.  选择“函数列表”，单击函数名称，进入函数详情界面。
3.  在函数详情界面，选择函数版本或者别名，单击“触发器”页签。
4.  在“触发器”页签，单击“创建触发器”，弹出“创建触发器”界面。
5.  在“创建触发器”界面填写触发器信息，如[表1](#table4277812911123)所示，带\*参数为必填项。

    **表 1**  触发器信息表

    <a name="table4277812911123"></a>
    <table><thead align="left"><tr id="row6452289411123"><th class="cellrowborder" valign="top" width="20.200000000000003%" id="mcps1.2.4.1.1"><p id="p6098502911123"><a name="p6098502911123"></a><a name="p6098502911123"></a>触发器类型</p>
    </th>
    <th class="cellrowborder" valign="top" width="22.220000000000002%" id="mcps1.2.4.1.2"><p id="p10222672111212"><a name="p10222672111212"></a><a name="p10222672111212"></a>字段</p>
    </th>
    <th class="cellrowborder" valign="top" width="57.58%" id="mcps1.2.4.1.3"><p id="p22730128111212"><a name="p22730128111212"></a><a name="p22730128111212"></a>填写说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row30343062142259"><td class="cellrowborder" valign="top" width="20.200000000000003%" headers="mcps1.2.4.1.1 "><p id="p35662995142358"><a name="p35662995142358"></a><a name="p35662995142358"></a>SMN</p>
    </td>
    <td class="cellrowborder" valign="top" width="22.220000000000002%" headers="mcps1.2.4.1.2 "><p id="p3021474142358"><a name="p3021474142358"></a><a name="p3021474142358"></a>*主题名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p38783594172823"><a name="p38783594172823"></a><a name="p38783594172823"></a>输入已创建消息主题，消息主题的创建请参考<a href="https://support.huaweicloud.com/usermanual-smn/zh-cn_topic_0043961401.html" target="_blank" rel="noopener noreferrer">创建消息主题</a>。</p>
    </td>
    </tr>
    <tr id="row4856597211123"><td class="cellrowborder" rowspan="3" valign="top" width="20.200000000000003%" headers="mcps1.2.4.1.1 "><p id="p31129588111234"><a name="p31129588111234"></a><a name="p31129588111234"></a>DMS</p>
    </td>
    <td class="cellrowborder" valign="top" width="22.220000000000002%" headers="mcps1.2.4.1.2 "><p id="p34968575111212"><a name="p34968575111212"></a><a name="p34968575111212"></a>*队列</p>
    </td>
    <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p49462051172823"><a name="p49462051172823"></a><a name="p49462051172823"></a>从已创建的DMS队列中选取，DMS队列创建请参考<a href="https://support.huaweicloud.com/usermanual-dms/zh-cn_topic_0034678324.html" target="_blank" rel="noopener noreferrer">创建队列</a>。</p>
    </td>
    </tr>
    <tr id="row5933491111123"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p53914942111212"><a name="p53914942111212"></a><a name="p53914942111212"></a>*消费组</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p49159901172823"><a name="p49159901172823"></a><a name="p49159901172823"></a>从已创建DMS队列对应的消费组中选取。DMS消费组的创建请参考<a href="https://support.huaweicloud.com/usermanual-dms/zh-cn_topic_0034678327.html" target="_blank" rel="noopener noreferrer">创建消费组</a>。</p>
    </td>
    </tr>
    <tr id="row2994931711123"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p46013745111212"><a name="p46013745111212"></a><a name="p46013745111212"></a>拉取周期</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p55109478142427"><a name="p55109478142427"></a><a name="p55109478142427"></a>消费消息拉取周期设置1-60秒的范围内。</p>
    </td>
    </tr>
    <tr id="row1972261712116"><td class="cellrowborder" rowspan="6" valign="top" width="20.200000000000003%" headers="mcps1.2.4.1.1 "><p id="p1056319620128"><a name="p1056319620128"></a><a name="p1056319620128"></a>APIG</p>
    <p id="p12942842135112"><a name="p12942842135112"></a><a name="p12942842135112"></a></p>
    </td>
    <td class="cellrowborder" valign="top" width="22.220000000000002%" headers="mcps1.2.4.1.2 "><p id="p1599355041110"><a name="p1599355041110"></a><a name="p1599355041110"></a>*API名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p1611005615198"><a name="p1611005615198"></a><a name="p1611005615198"></a>支持汉字，英文，数字，下划线，且只能以英文和汉字开头，3-24字符。</p>
    </td>
    </tr>
    <tr id="row1772361712118"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p01819517114"><a name="p01819517114"></a><a name="p01819517114"></a>*分组</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p3270906795938"><a name="p3270906795938"></a><a name="p3270906795938"></a>API分组相当于一个API集合，API提供方以API分组为单位，管理分组内的所有API。</p>
    <p id="p3172689114312"><a name="p3172689114312"></a><a name="p3172689114312"></a>从已创建的API分组中选择。</p>
    </td>
    </tr>
    <tr id="row27241317181113"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p20937182923211"><a name="p20937182923211"></a><a name="p20937182923211"></a>*发布环境</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p59381329153216"><a name="p59381329153216"></a><a name="p59381329153216"></a>API可以同时提供给不同的场景调用，如生产、测试或开发。API网关服务提供环境管理，在不同的环境定义不同的API调用路径。</p>
    </td>
    </tr>
    <tr id="row155361428101118"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p197231153163212"><a name="p197231153163212"></a><a name="p197231153163212"></a>*安全认证</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p11141193616518"><a name="p11141193616518"></a><a name="p11141193616518"></a>API认证方式有3种类型。</p>
    <a name="ul41378719143341"></a><a name="ul41378719143341"></a><ul id="ul41378719143341"><li>APP： 采用Appkey&amp;Appsecret认证，安全级别高，推荐使用，详情请参考<a href="https://support.huaweicloud.com/devg-apig/apig-zh-dev-180307002.html" target="_blank" rel="noopener noreferrer">APP认证</a>。</li><li>IAM： 华为IAM认证，只允许华为云用户能访问，安全级别中等，详情请参考<a href="https://support.huaweicloud.com/devg-apig/apig-zh-dev-180307020.html" target="_blank" rel="noopener noreferrer">IAM认证</a>。</li><li>None： 无认证模式，所有用户均可访问。</li></ul>
    </td>
    </tr>
    <tr id="row139746330117"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p77707145331"><a name="p77707145331"></a><a name="p77707145331"></a>*请求协议</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p8342198612"><a name="p8342198612"></a><a name="p8342198612"></a>分为两种类型：</p>
    <a name="ul10342591866"></a><a name="ul10342591866"></a><ul id="ul10342591866"><li>HTTP</li><li>HTTPS</li></ul>
    </td>
    </tr>
    <tr id="row2942174214512"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p2824122816478"><a name="p2824122816478"></a><a name="p2824122816478"></a>*后端超时(毫秒)</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p1550572654714"><a name="p1550572654714"></a><a name="p1550572654714"></a>取值范围：1-60000毫秒。</p>
    </td>
    </tr>
    <tr id="row1734255641519"><td class="cellrowborder" rowspan="4" valign="top" width="20.200000000000003%" headers="mcps1.2.4.1.1 "><p id="p334214567152"><a name="p334214567152"></a><a name="p334214567152"></a>OBS</p>
    </td>
    <td class="cellrowborder" valign="top" width="22.220000000000002%" headers="mcps1.2.4.1.2 "><p id="p133429569152"><a name="p133429569152"></a><a name="p133429569152"></a>*桶</p>
    </td>
    <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><a name="ul37345080152115"></a><a name="ul37345080152115"></a><ul id="ul37345080152115"><li>选择用作事件源的OBS存储桶。</li><li>从已创建OBS存储桶中选择，请选择与函数工作流服务同区的桶。</li><li>OBS存储桶的创建过程请参考<a href="https://support.huaweicloud.com/usermanual-obs/zh-cn_topic_0045829050.html" target="_blank" rel="noopener noreferrer">创建存储桶</a>。</li></ul>
    </td>
    </tr>
    <tr id="row1624161016209"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p5245107208"><a name="p5245107208"></a><a name="p5245107208"></a>*事件</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p22419107203"><a name="p22419107203"></a><a name="p22419107203"></a>选择要使其触发函数的事件。支持的事件类型请参考<a href="#functiongraph_01_0301__table44799992114531">表2</a>。</p>
    </td>
    </tr>
    <tr id="row267201413201"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p16672161432016"><a name="p16672161432016"></a><a name="p16672161432016"></a>前缀</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p06722014172010"><a name="p06722014172010"></a><a name="p06722014172010"></a>用来限制以此关键字开头的对象的事件通知，该限制可以实现对OBS对象名的过滤。</p>
    </td>
    </tr>
    <tr id="row194855184205"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p4485918172018"><a name="p4485918172018"></a><a name="p4485918172018"></a>后缀</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p174851218172018"><a name="p174851218172018"></a><a name="p174851218172018"></a>用来限制以此关键字结尾的对象的事件通知。该限制可以实现对OBS对象名的过滤。</p>
    </td>
    </tr>
    <tr id="row3465930102322"><td class="cellrowborder" rowspan="4" valign="top" width="20.200000000000003%" headers="mcps1.2.4.1.1 "><p id="p9923666102445"><a name="p9923666102445"></a><a name="p9923666102445"></a>DIS</p>
    </td>
    <td class="cellrowborder" valign="top" width="22.220000000000002%" headers="mcps1.2.4.1.2 "><p id="p43635721102322"><a name="p43635721102322"></a><a name="p43635721102322"></a>*通道名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p44832475102322"><a name="p44832475102322"></a><a name="p44832475102322"></a>选择已创建的DIS通道。</p>
    <p id="p27356511114344"><a name="p27356511114344"></a><a name="p27356511114344"></a>DIS通道的创建过程请参考<a href="https://support.huaweicloud.com/usermanual-dis/zh-cn_topic_0034903799.html" target="_blank" rel="noopener noreferrer">创建DIS通道</a>。</p>
    </td>
    </tr>
    <tr id="row65646631102322"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p7774150102322"><a name="p7774150102322"></a><a name="p7774150102322"></a>批处理大小</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p25726428102322"><a name="p25726428102322"></a><a name="p25726428102322"></a>设置调用函数时从流检索的记录的最大数目，可输入范围：1-10000</p>
    </td>
    </tr>
    <tr id="row53209872102322"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p1073764102322"><a name="p1073764102322"></a><a name="p1073764102322"></a>*起始位置</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p19866055102322"><a name="p19866055102322"></a><a name="p19866055102322"></a>在流中开始读取数据的位置。</p>
    <a name="ul6411007515240"></a><a name="ul6411007515240"></a><ul id="ul6411007515240"><li>RIM_HORIZON：是从数据流的起始位置获取。</li><li>LATEST是获取流中最新的数据。</li></ul>
    </td>
    </tr>
    <tr id="row3686280102322"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p2943675102322"><a name="p2943675102322"></a><a name="p2943675102322"></a>拉取周期</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p37111109102322"><a name="p37111109102322"></a><a name="p37111109102322"></a>设置拉取流数据的周期，拉取周期设置1-60秒的范围内。</p>
    </td>
    </tr>
    <tr id="row684712275488"><td class="cellrowborder" rowspan="4" valign="top" width="20.200000000000003%" headers="mcps1.2.4.1.1 "><p id="p183551993506"><a name="p183551993506"></a><a name="p183551993506"></a>TIMER</p>
    </td>
    <td class="cellrowborder" valign="top" width="22.220000000000002%" headers="mcps1.2.4.1.2 "><p id="p15824598113256"><a name="p15824598113256"></a><a name="p15824598113256"></a>*定时器名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p0473163953314"><a name="p0473163953314"></a><a name="p0473163953314"></a>支持字母、数字、下划线和中划线，必须以字母开头，且长度不能超过64个字符。</p>
    </td>
    </tr>
    <tr id="row9848172774810"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p2885379113256"><a name="p2885379113256"></a><a name="p2885379113256"></a>*触发规则</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><a name="ul86177526204"></a><a name="ul86177526204"></a><ul id="ul86177526204"><li>固定频率<p id="p1868131392114"><a name="p1868131392114"></a><a name="p1868131392114"></a>固定时间间隔触发函数，该类型下支持配置单位为分、时、天，每种类型仅支持整数配置，其中分钟支持范围(0，60]，小时支持范围(0，24]，天支持范围(0，30]。</p>
    </li><li>Cron表达式<p id="p81021165214"><a name="p81021165214"></a><a name="p81021165214"></a>可以完成更为复杂的函数执行计划：如周一到周五上午08:30:00执行函数等。请参考<a href="函数定时触发器Cron表达式规则.md">函数定时触发器Cron表达式规则</a>。</p>
    </li></ul>
    </td>
    </tr>
    <tr id="row6848172712488"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p56472765113256"><a name="p56472765113256"></a><a name="p56472765113256"></a>是否开启</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p10891263113256"><a name="p10891263113256"></a><a name="p10891263113256"></a>是否开启定时触发器。</p>
    </td>
    </tr>
    <tr id="row1484802719483"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p20885345113256"><a name="p20885345113256"></a><a name="p20885345113256"></a>附加信息</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p13991422113256"><a name="p13991422113256"></a><a name="p13991422113256"></a>如果用户配置了触发事件，会将该事件填写到TIMER事件源的"user_event"字段，详情请参考<a href="http://support.huaweicloud.com/devg-functiongraph/functiongraph_02_0102.html" target="_blank" rel="noopener noreferrer">支持的事件源</a>。</p>
    </td>
    </tr>
    <tr id="row136511516237"><td class="cellrowborder" rowspan="2" valign="top" width="20.200000000000003%" headers="mcps1.2.4.1.1 "><p id="p176511512313"><a name="p176511512313"></a><a name="p176511512313"></a>LTS</p>
    </td>
    <td class="cellrowborder" valign="top" width="22.220000000000002%" headers="mcps1.2.4.1.2 "><p id="p166511519231"><a name="p166511519231"></a><a name="p166511519231"></a>*日志组</p>
    </td>
    <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p166531251234"><a name="p166531251234"></a><a name="p166531251234"></a>日志管理的基本单位，用于日志存储及查询，创建过程请参考<a href="https://support.huaweicloud.com/qs-lts/zh-cn_topic_0067564152.html" target="_blank" rel="noopener noreferrer">创建日志组</a>。</p>
    </td>
    </tr>
    <tr id="row265315102311"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p196532518231"><a name="p196532518231"></a><a name="p196532518231"></a>*日志主题</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p965325102312"><a name="p965325102312"></a><a name="p965325102312"></a>在日志组下创建日志主题，订阅日志信息。创建过程请参考<a href="https://support.huaweicloud.com/qs-lts/zh-cn_topic_0067564153.html" target="_blank" rel="noopener noreferrer">创建日志主题</a>。</p>
    </td>
    </tr>
    <tr id="row14797132711133"><td class="cellrowborder" rowspan="5" valign="top" width="20.200000000000003%" headers="mcps1.2.4.1.1 "><p id="p37971027161315"><a name="p37971027161315"></a><a name="p37971027161315"></a>CTS</p>
    </td>
    <td class="cellrowborder" valign="top" width="22.220000000000002%" headers="mcps1.2.4.1.2 "><p id="p13260645163411"><a name="p13260645163411"></a><a name="p13260645163411"></a>*通知名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p17797142719132"><a name="p17797142719132"></a><a name="p17797142719132"></a>支持汉字、字母、数字和下划线，且长度不能超过64个字符。</p>
    </td>
    </tr>
    <tr id="row832311554144"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p42614455344"><a name="p42614455344"></a><a name="p42614455344"></a>*服务类型</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p133244557143"><a name="p133244557143"></a><a name="p133244557143"></a>选择相应的服务类型。</p>
    </td>
    </tr>
    <tr id="row2046613021516"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p626184510345"><a name="p626184510345"></a><a name="p626184510345"></a>*资源类型</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p74666061512"><a name="p74666061512"></a><a name="p74666061512"></a>所选服务下对应的资源类型。</p>
    </td>
    </tr>
    <tr id="row1958334661720"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p258311461178"><a name="p258311461178"></a><a name="p258311461178"></a>*操作名称</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p19583104618178"><a name="p19583104618178"></a><a name="p19583104618178"></a>所选资源类型下对应的操作。</p>
    </td>
    </tr>
    <tr id="row42221250181812"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p1122412508181"><a name="p1122412508181"></a><a name="p1122412508181"></a>*操作</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p02248509186"><a name="p02248509186"></a><a name="p02248509186"></a>可以进行“删除”的操作。</p>
    </td>
    </tr>
    </tbody>
    </table>

    **表 2**  OBS事件说明

    <a name="table44799992114531"></a>
    <table><thead align="left"><tr id="row48737262114531"><th class="cellrowborder" valign="top" width="21%" id="mcps1.2.4.1.1"><p id="p28875330114531"><a name="p28875330114531"></a><a name="p28875330114531"></a>事件类</p>
    </th>
    <th class="cellrowborder" valign="top" width="32%" id="mcps1.2.4.1.2"><p id="p57200411114531"><a name="p57200411114531"></a><a name="p57200411114531"></a>事件</p>
    </th>
    <th class="cellrowborder" valign="top" width="47%" id="mcps1.2.4.1.3"><p id="p2721684114531"><a name="p2721684114531"></a><a name="p2721684114531"></a>事件说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row24495156114531"><td class="cellrowborder" rowspan="5" valign="top" width="21%" headers="mcps1.2.4.1.1 "><p id="p37950592114531"><a name="p37950592114531"></a><a name="p37950592114531"></a>ObjectCreated</p>
    </td>
    <td class="cellrowborder" valign="top" width="32%" headers="mcps1.2.4.1.2 "><p id="p54099137114531"><a name="p54099137114531"></a><a name="p54099137114531"></a>—</p>
    </td>
    <td class="cellrowborder" valign="top" width="47%" headers="mcps1.2.4.1.3 "><p id="p36111109135927"><a name="p36111109135927"></a><a name="p36111109135927"></a>新对象创建事件，选择ObjectCreated时，意味着Put/Post/Copy/CompleteMultipartUpload都被选上。</p>
    </td>
    </tr>
    <tr id="row45368412114531"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p34343507114531"><a name="p34343507114531"></a><a name="p34343507114531"></a>Put</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p30360720114531"><a name="p30360720114531"></a><a name="p30360720114531"></a>更新对象。</p>
    </td>
    </tr>
    <tr id="row4811027114531"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p23983720114531"><a name="p23983720114531"></a><a name="p23983720114531"></a>Post</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p63633133114531"><a name="p63633133114531"></a><a name="p63633133114531"></a>上传对象。</p>
    </td>
    </tr>
    <tr id="row35827286114531"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p47588189114531"><a name="p47588189114531"></a><a name="p47588189114531"></a>Copy</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p29438085114531"><a name="p29438085114531"></a><a name="p29438085114531"></a>复制对象。</p>
    </td>
    </tr>
    <tr id="row63616174114531"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p63269305114649"><a name="p63269305114649"></a><a name="p63269305114649"></a>CompleteMultipartUpload</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p42098801405"><a name="p42098801405"></a><a name="p42098801405"></a>使用多段上传方式上传对象，多个段成功合并时触发。</p>
    </td>
    </tr>
    <tr id="row52672745114531"><td class="cellrowborder" rowspan="3" valign="top" width="21%" headers="mcps1.2.4.1.1 "><p id="p38633980114531"><a name="p38633980114531"></a><a name="p38633980114531"></a>ObjectRemoved</p>
    </td>
    <td class="cellrowborder" valign="top" width="32%" headers="mcps1.2.4.1.2 "><p id="p42344655114531"><a name="p42344655114531"></a><a name="p42344655114531"></a>—</p>
    </td>
    <td class="cellrowborder" valign="top" width="47%" headers="mcps1.2.4.1.3 "><p id="p6335903214027"><a name="p6335903214027"></a><a name="p6335903214027"></a>对象删除事件，选择ObjectRemoved，意味着Delete/DeleteMarkerCreated都被选上。</p>
    </td>
    </tr>
    <tr id="row66285022114531"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p30596785114531"><a name="p30596785114531"></a><a name="p30596785114531"></a>Delete</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p62420541114531"><a name="p62420541114531"></a><a name="p62420541114531"></a>对象删除。</p>
    </td>
    </tr>
    <tr id="row6953132114827"><td class="cellrowborder" valign="top" headers="mcps1.2.4.1.1 "><p id="p35668554114827"><a name="p35668554114827"></a><a name="p35668554114827"></a>DeleteMarkerCreated</p>
    </td>
    <td class="cellrowborder" valign="top" headers="mcps1.2.4.1.2 "><p id="p3167791414110"><a name="p3167791414110"></a><a name="p3167791414110"></a>在OBS服务开启多版本支持后，如果不指定版本号删除对象，OBS会自动为该对象生成删除标记，此时会触发本事件。</p>
    </td>
    </tr>
    </tbody>
    </table>

6.  单击“确定”，完成触发器创建。

## 使用触发器<a name="section197919416319"></a>

触发器实现了与对应华为云服务的对接，触发器创建以后，会按照预置的机制运行，本节介绍触发器的使用说明。

**SMN触发器使用说明**

创建SMN触发器有如下两种方法。

-   在消息通知服务消息主题添加FunctionGraph类型消息订阅，详见[添加订阅（创建SMN触发器）](添加订阅（创建SMN触发器）.md)。
-   在FunctionGraph函数详情页触发器栏目创建SMN类型触发器。

SMN触发器创建成功以后，如果订阅主题有消息发布，会触发函数执行，函数触发是异步调用的方式，具体示例事件请参见[支持的事件源](http://support.huaweicloud.com/devg-functiongraph/functiongraph_02_0102.html)。

**DMS触发器使用说明**

1.  创建DMS触发器，必须设置DMS权限委托。
    1.  创建包含DMS的委托，请参考[创建委托](创建委托.md)。
    2.  创建函数过程中设置委托请参考[4.a](函数管理.md#li39649257142215)。
    3.  函数已创建，修改函数委托，请参考[设置函数委托](使用DMS触发器.md#section82781591521)。

2.  如果函数没有设置权限委托或者设置的委托不包含DMS权限，在创建DMS触发器时，FunctionGraph无法加载已经创建的消息队列。
3.  创建触发器时设置的拉取周期，就是轮询DMS消息队列的间隔。如果是10s，触发器创建以后，每隔10s，FunctionGraph会自动拉取消息队列中的消息，触发函数运行，具体示例事件请参见[支持的事件源](http://support.huaweicloud.com/devg-functiongraph/functiongraph_02_0102.html)。

**APIG触发器使用说明**

APIG触发器创建以后，获得调用地址，示例如下。并且在API网关服务中生成对应的API，可以通过API调用函数。

https://49016d58-558a-4d88-ab42-f8e6e6f84bc8.apigw.cn-north-1.huaweicloud.com/read\_apig\_message

-   APP认证类型的API访问说明，请参考[APP认证](https://support.huaweicloud.com/devg-apig/apig-zh-dev-180307002.html)。

-   IAM认证类型的API访问说明，请参考[IAM认证](https://support.huaweicloud.com/devg-apig/apig-zh-dev-180307020.html)。

-   None认证类型的API访问说明，请参考[None认证](https://support.huaweicloud.com/devg-apig/apig-zh-dev-180307024.html)。

**OBS触发器使用说明**

-   创建OBS触发器时，所选择的OBS桶要与函数工作流服务在同一区域。例如函数工作流服务在“华北-北京一”，应该选择“华北-北京一”的存储桶。
-   OBS触发器创建以后，如果OBS对象有对应事件产生（如上传、删除、修改），会自动触发函数运行。
-   用户可以通过设置OBS触发器前缀或者后缀对存储对象进行过滤，示例：如果设置前缀为image，后缀为jpg。只有对类似image0001.jpg的对象操作才会触发函数，对类似im0001.jpg或者image0001.zip的对象操作均不会触发函数。

**DIS触发器使用说明**

1.  创建DIS触发器，必须设置DIS权限委托。
    1.  创建包含DIS权限的委托，请参考[创建委托](创建委托.md)。
    2.  创建函数过程中设置委托请参考[4.a](函数管理.md#li39649257142215)。
    3.  函数已创建，修改函数委托，请参考[设置函数委托](使用DIS触发器.md#section04468211232)。

2.  如果函数没有设置权限委托或者设置的委托不包含DIS权限，在创建DIS触发器时，FunctionGraph无法加载已经创建的DIS消息通道。
3.  创建触发器时设置的拉取周期，就是轮询DIS数据的时间间隔。如果是10s，触发器创建以后，每隔10s，FunctionGraph会自动拉取DIS通道中的数据，触发函数运行，具体示例事件请参见[支持的事件源](http://support.huaweicloud.com/devg-functiongraph/functiongraph_02_0102.html)。

**TIMER触发器使用说明**

定时触发器支持两种触发规则配置。

1.  Rate类型，及固定时间间隔触发，该类型下支持配置单位为分、时、天，每种类型仅支持整数配置，其中分钟支持范围\(0，60\]，小时支持范围\(0，24\]，天支持范围\(0，30\]。
2.  Cron表达式类型，Cron表达式可以完成更为复杂的函数执行计划：如周一到周五上午08:30:00执行函数、每月1，2，3号上午07:45:00执行等。请参考[函数定时触发器Cron表达式规则](函数定时触发器Cron表达式规则.md)。

**LTS触发器使用说明**

LTS触发器实现了与华为云云日志服务的对接。当云日志服务采集到订阅的日志后，可以通过将采集到的日志作为参数传递来自动调用FunctionGraph函数，FunctionGraph函数代码可以对其进行自定义处理、分析或将其加载到其他系统。

**CTS触发器使用说明**

CTS触发器实现了函数与CTS云审计服务的对接。用户创建函数CTS触发器，根据CTS云审计服务类型和操作订阅所需要的事件通知，函数通过CTS触发器实时获取已订阅的CTS云审计服务操作记录。经由自定义函数对日志中的关键信息进行分析和处理，对系统、网络等业务模块进行自动修复，或通过短信、邮件等形式产生告警，通知业务人员进行处理。

## 停用（启用）触发器<a name="section47341940132219"></a>

已经创建的触发器，可以设置停用（启用），确定触发器的可用状态。其中SMN触发器、OBS触发器、APIG触发器创建以后，不能停止，只能删除。

1.  用户登录FunctionGraph，进入“函数”界面。
2.  选择“函数列表”，单击函数名称，进入函数详情界面。
3.  在函数详情界面，选择函数版本或者别名，单击“触发器”页签。
4.  在“触发器”页签，选择触发器，单击“停用（启用）”，完成触发器停用（启用）操作。

## 删除触发器<a name="section65736020471"></a>

对于已经创建的触发器，如果不再使用，可以执行删除操作。

1.  用户登录FunctionGraph，进入“函数”界面。
2.  选择“函数列表”，单击函数名称，进入函数详情界面。
3.  在函数详情界面，选择函数版本或者别名，单击“触发器”页签。
4.  在“触发器”页签，选择待删除触发器，单击“删除”，弹出“删除触发器”界面。
5.  在“删除触发器界面”，输入“DELETE”（大写），单击“确定”，完成触发器删除操作。如[图1](#fig1930095095918)所示。

    **图 1**  删除触发器<a name="fig1930095095918"></a>  
    ![](figures/删除触发器.png "删除触发器")


