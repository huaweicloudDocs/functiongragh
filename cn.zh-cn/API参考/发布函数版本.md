# 发布函数版本<a name="functiongraph_06_0112"></a>

## 功能介绍<a name="section26279997"></a>

发布函数版本。

## URI<a name="section35193385"></a>

URL：/v1.0/\{project\_id\}/fss/functions/\{function\_urn\}/versions

Method：POST

以最新latest代码发布版本，版本号系统自动生成，一个函数最多只能有10个版本。

参数说明如[表1](#d0e3819)所示。

**表 1**  参数说明

<a name="d0e3819"></a>
<table><thead align="left"><tr id="row59066360"><th class="cellrowborder" valign="top" width="17.349999999999998%" id="mcps1.2.5.1.1"><p id="p19645846"><a name="p19645846"></a><a name="p19645846"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="12.24%" id="mcps1.2.5.1.2"><p id="p47809697"><a name="p47809697"></a><a name="p47809697"></a>类型</p>
</th>
<th class="cellrowborder" valign="top" width="14.29%" id="mcps1.2.5.1.3"><p id="p47380224"><a name="p47380224"></a><a name="p47380224"></a>必选</p>
</th>
<th class="cellrowborder" valign="top" width="56.120000000000005%" id="mcps1.2.5.1.4"><p id="p12592924"><a name="p12592924"></a><a name="p12592924"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row13393884"><td class="cellrowborder" valign="top" width="17.349999999999998%" headers="mcps1.2.5.1.1 "><p id="p11162792"><a name="p11162792"></a><a name="p11162792"></a>project_id</p>
</td>
<td class="cellrowborder" valign="top" width="12.24%" headers="mcps1.2.5.1.2 "><p id="p31770985"><a name="p31770985"></a><a name="p31770985"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="14.29%" headers="mcps1.2.5.1.3 "><p id="p23313031"><a name="p23313031"></a><a name="p23313031"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="56.120000000000005%" headers="mcps1.2.5.1.4 "><p id="p9307369"><a name="p9307369"></a><a name="p9307369"></a>Project Id。</p>
</td>
</tr>
<tr id="row16657464"><td class="cellrowborder" valign="top" width="17.349999999999998%" headers="mcps1.2.5.1.1 "><p id="p7077307"><a name="p7077307"></a><a name="p7077307"></a>function_urn</p>
</td>
<td class="cellrowborder" valign="top" width="12.24%" headers="mcps1.2.5.1.2 "><p id="p36391032"><a name="p36391032"></a><a name="p36391032"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="14.29%" headers="mcps1.2.5.1.3 "><p id="p61992469"><a name="p61992469"></a><a name="p61992469"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="56.120000000000005%" headers="mcps1.2.5.1.4 "><p id="p55334074"><a name="p55334074"></a><a name="p55334074"></a>函数的URN，详细解释见<a href="FunctionGraph函数模型.md">FunctionGraph函数模型</a>的描述。</p>
</td>
</tr>
</tbody>
</table>

## 请求消息<a name="section48305013"></a>

**请求参数**

<a name="table25404982"></a>
<table><thead align="left"><tr id="row44073485"><th class="cellrowborder" valign="top" width="17.349999999999998%" id="mcps1.1.5.1.1"><p id="p13182542"><a name="p13182542"></a><a name="p13182542"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="16.33%" id="mcps1.1.5.1.2"><p id="p61152983"><a name="p61152983"></a><a name="p61152983"></a>类型</p>
</th>
<th class="cellrowborder" valign="top" width="12.24%" id="mcps1.1.5.1.3"><p id="p54444625"><a name="p54444625"></a><a name="p54444625"></a>必选</p>
</th>
<th class="cellrowborder" valign="top" width="54.08%" id="mcps1.1.5.1.4"><p id="p47938532"><a name="p47938532"></a><a name="p47938532"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row57815863"><td class="cellrowborder" valign="top" width="17.349999999999998%" headers="mcps1.1.5.1.1 "><p id="p52573298"><a name="p52573298"></a><a name="p52573298"></a>Digest</p>
</td>
<td class="cellrowborder" valign="top" width="16.33%" headers="mcps1.1.5.1.2 "><p id="p30578750"><a name="p30578750"></a><a name="p30578750"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="12.24%" headers="mcps1.1.5.1.3 "><p id="p60959682"><a name="p60959682"></a><a name="p60959682"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="54.08%" headers="mcps1.1.5.1.4 "><p id="p38787239"><a name="p38787239"></a><a name="p38787239"></a>要发布的函数的代码的digest，如不提供则使用latest版本的代码进行发布。</p>
</td>
</tr>
<tr id="row144221654134316"><td class="cellrowborder" valign="top" width="17.349999999999998%" headers="mcps1.1.5.1.1 "><p id="p94221154204315"><a name="p94221154204315"></a><a name="p94221154204315"></a>Version</p>
</td>
<td class="cellrowborder" valign="top" width="16.33%" headers="mcps1.1.5.1.2 "><p id="p16422155411431"><a name="p16422155411431"></a><a name="p16422155411431"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="12.24%" headers="mcps1.1.5.1.3 "><p id="p19422254204317"><a name="p19422254204317"></a><a name="p19422254204317"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="54.08%" headers="mcps1.1.5.1.4 "><p id="p6422554204318"><a name="p6422554204318"></a><a name="p6422554204318"></a>待发布的版本号，如果未指定，则会使用当前时间格式化为"yyyymmdd-HHMMSS"的字符串作为发布版本号</p>
</td>
</tr>
<tr id="row13540837"><td class="cellrowborder" valign="top" width="17.349999999999998%" headers="mcps1.1.5.1.1 "><p id="p23066046"><a name="p23066046"></a><a name="p23066046"></a>Description</p>
</td>
<td class="cellrowborder" valign="top" width="16.33%" headers="mcps1.1.5.1.2 "><p id="p56410443"><a name="p56410443"></a><a name="p56410443"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="12.24%" headers="mcps1.1.5.1.3 "><p id="p5843189"><a name="p5843189"></a><a name="p5843189"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="54.08%" headers="mcps1.1.5.1.4 "><p id="p3536291"><a name="p3536291"></a><a name="p3536291"></a>要发布的版本描述。</p>
</td>
</tr>
</tbody>
</table>

**请求示例**

```
POST /v1.0/7aad83af3e8d42e99ac194e8419e2c9b/fss/functions/urn:fss:cn-north-1:7aad83af3e8d42e99ac194e8419e2c9b:function:default:test:latest/versions HTTP/1.1
{
  "Digest": "",
  "Description": "test"
}
```

## 响应消息<a name="section32091938"></a>

**响应参数**

函数的metadata信息：JSON对象，表示指定函数的metadata信息。

**响应示例**

成功时的返回格式：

```
HTTP / 1.1 200
{
	"CodeFileName": "index.js",
	"CodeSize": 272,
	"CodeType": "inline",
	"CodeUrl": "",
	"Cpu": 300,
	"DependencyPkg": "",
	"Description": "111",
	"Digest": "decbce6939297b0b5ec6d1a23bf9c725870f5e69fc338a89a6a4029264688dc26338f56d08b6535de47f15ad538e22ca66613b9a46f807d50b687bb53fded1c6",
	"FuncName": "test",
	"FuncUrn": "urn:fss:cn-north-1:7aad83af3e8d42e99ac194e8419e2c9b:function:default:test:v20180329-163907",
	"Handler": "test.handler",
	"ImageName": "v20180329-163907",
	"LastModified": "2018-03-29T16:39:07+08:00",
	"MemorySize": 128,
	"Namespace": "7aad83af3e8d42e99ac194e8419e2c9b",
	"Package": "default",
	"ProjectName": "cn-north-1",
	"Runtime": "Node.js6.10",
	"Timeout": 3,
	"UserData": "",
	"UserDomain": "cff01_hk",
	"Version": "v20180329-163907",
	"VersionDescription": "test",
	"Xrole": "cff"
}
```

失败时的返回格式（示例）：

```
HTTP / 1.1 404 Not Found 
{
	"error_code": "FSS.1051",
	"error_msg": "Not found the function"
}
```

## 状态码<a name="section20391994"></a>

状态码说明如[表2](#d0e3900)所示。

**表 2**  状态码说明

<a name="d0e3900"></a>
<table><thead align="left"><tr id="row38947203"><th class="cellrowborder" valign="top" width="13%" id="mcps1.2.3.1.1"><p id="p606845"><a name="p606845"></a><a name="p606845"></a>状态码</p>
</th>
<th class="cellrowborder" valign="top" width="87%" id="mcps1.2.3.1.2"><p id="p49154467"><a name="p49154467"></a><a name="p49154467"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row22088927"><td class="cellrowborder" valign="top" width="13%" headers="mcps1.2.3.1.1 "><p id="p44372630"><a name="p44372630"></a><a name="p44372630"></a>400</p>
</td>
<td class="cellrowborder" valign="top" width="87%" headers="mcps1.2.3.1.2 "><p id="p37413298"><a name="p37413298"></a><a name="p37413298"></a>InvalidParameterValueException：输入参数错误。</p>
</td>
</tr>
<tr id="row1175370"><td class="cellrowborder" valign="top" width="13%" headers="mcps1.2.3.1.1 "><p id="p28096120"><a name="p28096120"></a><a name="p28096120"></a>401</p>
</td>
<td class="cellrowborder" valign="top" width="87%" headers="mcps1.2.3.1.2 "><p id="p61193214"><a name="p61193214"></a><a name="p61193214"></a>UnauthorizedAccess：未授权的访问。</p>
</td>
</tr>
<tr id="row13868018"><td class="cellrowborder" valign="top" width="13%" headers="mcps1.2.3.1.1 "><p id="p49567664"><a name="p49567664"></a><a name="p49567664"></a>403</p>
</td>
<td class="cellrowborder" valign="top" width="87%" headers="mcps1.2.3.1.2 "><p id="p55557851"><a name="p55557851"></a><a name="p55557851"></a>Forbidden：禁止访问或创建的版本个数超出限制。</p>
</td>
</tr>
<tr id="row30258612"><td class="cellrowborder" valign="top" width="13%" headers="mcps1.2.3.1.1 "><p id="p35028525"><a name="p35028525"></a><a name="p35028525"></a>404</p>
</td>
<td class="cellrowborder" valign="top" width="87%" headers="mcps1.2.3.1.2 "><p id="p18738246"><a name="p18738246"></a><a name="p18738246"></a>ResourceNotFoundException：未找到指定的函数。</p>
</td>
</tr>
<tr id="row414713229212"><td class="cellrowborder" valign="top" width="13%" headers="mcps1.2.3.1.1 "><p id="p14179142824616"><a name="p14179142824616"></a><a name="p14179142824616"></a>409</p>
</td>
<td class="cellrowborder" valign="top" width="87%" headers="mcps1.2.3.1.2 "><p id="p517912813469"><a name="p517912813469"></a><a name="p517912813469"></a>ResourceConflictException：函数已存在。</p>
</td>
</tr>
<tr id="row34426486"><td class="cellrowborder" valign="top" width="13%" headers="mcps1.2.3.1.1 "><p id="p37081954"><a name="p37081954"></a><a name="p37081954"></a>429</p>
</td>
<td class="cellrowborder" valign="top" width="87%" headers="mcps1.2.3.1.2 "><p id="p50848323"><a name="p50848323"></a><a name="p50848323"></a>TooManyRequestsException：并发请求数太多。</p>
</td>
</tr>
<tr id="row54981731"><td class="cellrowborder" valign="top" width="13%" headers="mcps1.2.3.1.1 "><p id="p24335246"><a name="p24335246"></a><a name="p24335246"></a>500</p>
</td>
<td class="cellrowborder" valign="top" width="87%" headers="mcps1.2.3.1.2 "><p id="p24997922"><a name="p24997922"></a><a name="p24997922"></a>InternalServerError：服务内部出错。</p>
</td>
</tr>
</tbody>
</table>

