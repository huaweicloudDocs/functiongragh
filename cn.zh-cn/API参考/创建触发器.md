# 创建触发器<a name="functiongraph_06_0122"></a>

## 功能介绍<a name="section25653620"></a>

创建触发器。

## URI<a name="section29555991"></a>

URL：/v2/\{project\_id\}/fgs/triggers/\{function\_urn\}

Method：POST

参数说明如[表1](#d0e5632)所示。

**表 1**  参数说明

<a name="d0e5632"></a>
<table><thead align="left"><tr id="row61148692"><th class="cellrowborder" valign="top" width="19.39%" id="mcps1.2.5.1.1"><p id="p54097009"><a name="p54097009"></a><a name="p54097009"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="16.330000000000002%" id="mcps1.2.5.1.2"><p id="p19781590"><a name="p19781590"></a><a name="p19781590"></a>类型</p>
</th>
<th class="cellrowborder" valign="top" width="10.200000000000001%" id="mcps1.2.5.1.3"><p id="p58804972"><a name="p58804972"></a><a name="p58804972"></a>必选</p>
</th>
<th class="cellrowborder" valign="top" width="54.080000000000005%" id="mcps1.2.5.1.4"><p id="p65582298"><a name="p65582298"></a><a name="p65582298"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row10565961"><td class="cellrowborder" valign="top" width="19.39%" headers="mcps1.2.5.1.1 "><p id="p50536545"><a name="p50536545"></a><a name="p50536545"></a>project_id</p>
</td>
<td class="cellrowborder" valign="top" width="16.330000000000002%" headers="mcps1.2.5.1.2 "><p id="p66928329"><a name="p66928329"></a><a name="p66928329"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="10.200000000000001%" headers="mcps1.2.5.1.3 "><p id="p52485545"><a name="p52485545"></a><a name="p52485545"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="54.080000000000005%" headers="mcps1.2.5.1.4 "><p id="p23470762"><a name="p23470762"></a><a name="p23470762"></a>Project Id。</p>
</td>
</tr>
<tr id="row9910270"><td class="cellrowborder" valign="top" width="19.39%" headers="mcps1.2.5.1.1 "><p id="p64534419"><a name="p64534419"></a><a name="p64534419"></a>function_urn</p>
</td>
<td class="cellrowborder" valign="top" width="16.330000000000002%" headers="mcps1.2.5.1.2 "><p id="p59905436"><a name="p59905436"></a><a name="p59905436"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="10.200000000000001%" headers="mcps1.2.5.1.3 "><p id="p20502146"><a name="p20502146"></a><a name="p20502146"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="54.080000000000005%" headers="mcps1.2.5.1.4 "><p id="p50061100"><a name="p50061100"></a><a name="p50061100"></a>函数的URN，详细解释见<a href="FunctionGraph函数模型.md">FunctionGraph函数模型</a>的描述。</p>
</td>
</tr>
</tbody>
</table>

## 请求消息<a name="section64677330"></a>

**请求参数**

参数说明如[表2](#table22104835)所示。

**表 2**  参数说明表

<a name="table22104835"></a>
<table><thead align="left"><tr id="row21741052"><th class="cellrowborder" valign="top" width="25.252525252525253%" id="mcps1.2.5.1.1"><p id="p16194779"><a name="p16194779"></a><a name="p16194779"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="25.252525252525253%" id="mcps1.2.5.1.2"><p id="p36708747"><a name="p36708747"></a><a name="p36708747"></a>类型</p>
</th>
<th class="cellrowborder" valign="top" width="17.17171717171717%" id="mcps1.2.5.1.3"><p id="p20618548"><a name="p20618548"></a><a name="p20618548"></a>必选</p>
</th>
<th class="cellrowborder" valign="top" width="32.32323232323232%" id="mcps1.2.5.1.4"><p id="p59489661"><a name="p59489661"></a><a name="p59489661"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row53933198"><td class="cellrowborder" valign="top" width="25.252525252525253%" headers="mcps1.2.5.1.1 "><p id="p6512912"><a name="p6512912"></a><a name="p6512912"></a>trigger_type_code</p>
</td>
<td class="cellrowborder" valign="top" width="25.252525252525253%" headers="mcps1.2.5.1.2 "><p id="p57783850"><a name="p57783850"></a><a name="p57783850"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="17.17171717171717%" headers="mcps1.2.5.1.3 "><p id="p49980293"><a name="p49980293"></a><a name="p49980293"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="32.32323232323232%" headers="mcps1.2.5.1.4 "><p id="p21871945"><a name="p21871945"></a><a name="p21871945"></a>触发器类型</p>
</td>
</tr>
<tr id="row62629777"><td class="cellrowborder" valign="top" width="25.252525252525253%" headers="mcps1.2.5.1.1 "><p id="p39847172"><a name="p39847172"></a><a name="p39847172"></a>event_type_code</p>
</td>
<td class="cellrowborder" valign="top" width="25.252525252525253%" headers="mcps1.2.5.1.2 "><p id="p6395508"><a name="p6395508"></a><a name="p6395508"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="17.17171717171717%" headers="mcps1.2.5.1.3 "><p id="p48274120"><a name="p48274120"></a><a name="p48274120"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="32.32323232323232%" headers="mcps1.2.5.1.4 "><p id="p17889641"><a name="p17889641"></a><a name="p17889641"></a>事件类型</p>
</td>
</tr>
<tr id="row26789041"><td class="cellrowborder" valign="top" width="25.252525252525253%" headers="mcps1.2.5.1.1 "><p id="p22428719"><a name="p22428719"></a><a name="p22428719"></a>event_data</p>
</td>
<td class="cellrowborder" valign="top" width="25.252525252525253%" headers="mcps1.2.5.1.2 "><p id="p4786990"><a name="p4786990"></a><a name="p4786990"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="17.17171717171717%" headers="mcps1.2.5.1.3 "><p id="p52201942"><a name="p52201942"></a><a name="p52201942"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="32.32323232323232%" headers="mcps1.2.5.1.4 "><p id="p498894"><a name="p498894"></a><a name="p498894"></a>事件消息</p>
</td>
</tr>
</tbody>
</table>

**请求示例**

```
POST /v2/7aad83af3e8d42e99ac194e8419e2c9b/fgs/triggers/urn:fss:cn-north-1:7aad83af3e8d42e99ac194e8419e2c9b:function:default:test:latest
{
"trigger_type_code": "OBS",
"event_type_code": "MessageCreated",
"event_data": {
"bucket": "yourBucketName",
"events": ["s3:ObjectCreated:Put"],
"prefix": "yourPrefix",
"suffix": "yourSuffix"
}
}
```

## 响应消息<a name="section45225062"></a>

**响应参数**

响应参数如[表3](#table394445163918)所示。    

**表 3**  响应参数

<a name="table394445163918"></a>
<table><thead align="left"><tr id="row5944851163912"><th class="cellrowborder" valign="top" width="17.791779177917793%" id="mcps1.2.4.1.1"><p id="p7944165193912"><a name="p7944165193912"></a><a name="p7944165193912"></a>名称</p>
</th>
<th class="cellrowborder" valign="top" width="19.01190119011901%" id="mcps1.2.4.1.2"><p id="p494413519391"><a name="p494413519391"></a><a name="p494413519391"></a>参数类型</p>
</th>
<th class="cellrowborder" valign="top" width="63.19631963196319%" id="mcps1.2.4.1.3"><p id="p159441351193918"><a name="p159441351193918"></a><a name="p159441351193918"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row656714506269"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p897220169325"><a name="p897220169325"></a><a name="p897220169325"></a>trigger_id</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p460264122514"><a name="p460264122514"></a><a name="p460264122514"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p3971716113216"><a name="p3971716113216"></a><a name="p3971716113216"></a>触发器ID。</p>
</td>
</tr>
<tr id="row1447114561264"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p19701163322"><a name="p19701163322"></a><a name="p19701163322"></a>trigger_type_code</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p6987191613254"><a name="p6987191613254"></a><a name="p6987191613254"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p296918163326"><a name="p296918163326"></a><a name="p296918163326"></a>触发器类型代码。</p>
</td>
</tr>
<tr id="row7901759114116"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p12901145974116"><a name="p12901145974116"></a><a name="p12901145974116"></a>event_type_code</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p121351772514"><a name="p121351772514"></a><a name="p121351772514"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p19901959104112"><a name="p19901959104112"></a><a name="p19901959104112"></a>事件类型代码。</p>
</td>
</tr>
<tr id="row105681318124210"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p10568101814215"><a name="p10568101814215"></a><a name="p10568101814215"></a>trigger_status</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p31818174253"><a name="p31818174253"></a><a name="p31818174253"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p756861834215"><a name="p756861834215"></a><a name="p756861834215"></a>触发器状态：ACTIVE / DISABLED。</p>
</td>
</tr>
<tr id="row171881259182617"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p15535100113911"><a name="p15535100113911"></a><a name="p15535100113911"></a>event_data</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p1721191722510"><a name="p1721191722510"></a><a name="p1721191722510"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p1596641617325"><a name="p1596641617325"></a><a name="p1596641617325"></a>触发器相关定义数据，以JSON结构形式出现。</p>
</td>
</tr>
<tr id="row560413428426"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p12604184219426"><a name="p12604184219426"></a><a name="p12604184219426"></a>bucket</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p82641782518"><a name="p82641782518"></a><a name="p82641782518"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p206041542154210"><a name="p206041542154210"></a><a name="p206041542154210"></a>OBS桶名。</p>
</td>
</tr>
<tr id="row128655571423"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p1865175715421"><a name="p1865175715421"></a><a name="p1865175715421"></a>events</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p632101722516"><a name="p632101722516"></a><a name="p632101722516"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p1086517578428"><a name="p1086517578428"></a><a name="p1086517578428"></a>OBS触发事件集合。</p>
</td>
</tr>
<tr id="row1929671274311"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p152961812124320"><a name="p152961812124320"></a><a name="p152961812124320"></a>prefix</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p1936161710256"><a name="p1936161710256"></a><a name="p1936161710256"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p1992153064918"><a name="p1992153064918"></a><a name="p1992153064918"></a>OBS对象的前缀。</p>
</td>
</tr>
<tr id="row860316247437"><td class="cellrowborder" valign="top" width="17.791779177917793%" headers="mcps1.2.4.1.1 "><p id="p176030241433"><a name="p176030241433"></a><a name="p176030241433"></a>suffix</p>
</td>
<td class="cellrowborder" valign="top" width="19.01190119011901%" headers="mcps1.2.4.1.2 "><p id="p164281722512"><a name="p164281722512"></a><a name="p164281722512"></a>string</p>
</td>
<td class="cellrowborder" valign="top" width="63.19631963196319%" headers="mcps1.2.4.1.3 "><p id="p19921153010497"><a name="p19921153010497"></a><a name="p19921153010497"></a>OBS对象的后缀。</p>
</td>
</tr>
</tbody>
</table>

**响应示例**

成功时的返回格式：

```
HTTP/1.1 201 Created 
{ 
    "trigger_id":"191e425a-924a-45d9-b730-38b5ffe338ad", 
    "trigger_type_code":"OBS", 
    "event_type_code":"MessageCreated", 
    "trigger_status":"ACTIVE", 
    "event_data":{ 
    "bucket": "yourBucketName",  
"events": ["s3:ObjectCreated:Put"],  
"prefix": "yourPrefix",  
"suffix": "yourSuffix"
        }, 
    "last_updated_time":"2017-06-27 23:33:57 +0000 UTC", 
    "created_time":"2017-06-27 23:33:57 +0000 UTC" 
}
```

失败时的返回格式（示例）：

```
HTTP/1.1 404 Not Found 
{ 
  "error_code": "FSS.1051", 
  "error_msg": "Error getting associated function" 
 }
```

## 状态码<a name="section4372381"></a>

状态码说明如[表4](#d0e5749)所示。

**表 4**  状态码说明

<a name="d0e5749"></a>
<table><thead align="left"><tr id="row5563967"><th class="cellrowborder" valign="top" width="13.13%" id="mcps1.2.3.1.1"><p id="p48028206"><a name="p48028206"></a><a name="p48028206"></a>状态码</p>
</th>
<th class="cellrowborder" valign="top" width="86.87%" id="mcps1.2.3.1.2"><p id="p65079473"><a name="p65079473"></a><a name="p65079473"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row36945969"><td class="cellrowborder" valign="top" width="13.13%" headers="mcps1.2.3.1.1 "><p id="p39833493"><a name="p39833493"></a><a name="p39833493"></a>400</p>
</td>
<td class="cellrowborder" valign="top" width="86.87%" headers="mcps1.2.3.1.2 "><p id="p5287494"><a name="p5287494"></a><a name="p5287494"></a>BadRequest：请求数据有错。</p>
</td>
</tr>
<tr id="row47587446"><td class="cellrowborder" valign="top" width="13.13%" headers="mcps1.2.3.1.1 "><p id="p29377924"><a name="p29377924"></a><a name="p29377924"></a>401</p>
</td>
<td class="cellrowborder" valign="top" width="86.87%" headers="mcps1.2.3.1.2 "><p id="p30801683"><a name="p30801683"></a><a name="p30801683"></a>UnauthorizedRequest：未授权请求。</p>
</td>
</tr>
<tr id="row13760515154314"><td class="cellrowborder" valign="top" width="13.13%" headers="mcps1.2.3.1.1 "><p id="p137601815154313"><a name="p137601815154313"></a><a name="p137601815154313"></a>403</p>
</td>
<td class="cellrowborder" valign="top" width="86.87%" headers="mcps1.2.3.1.2 "><p id="p9760111516437"><a name="p9760111516437"></a><a name="p9760111516437"></a>Forbidden：禁止访问。</p>
</td>
</tr>
<tr id="row8779699"><td class="cellrowborder" valign="top" width="13.13%" headers="mcps1.2.3.1.1 "><p id="p40066981"><a name="p40066981"></a><a name="p40066981"></a>404</p>
</td>
<td class="cellrowborder" valign="top" width="86.87%" headers="mcps1.2.3.1.2 "><p id="p24200044"><a name="p24200044"></a><a name="p24200044"></a>ResourceNotFoundException：函数没有找到。</p>
</td>
</tr>
<tr id="row16473811"><td class="cellrowborder" valign="top" width="13.13%" headers="mcps1.2.3.1.1 "><p id="p59310324"><a name="p59310324"></a><a name="p59310324"></a>409</p>
</td>
<td class="cellrowborder" valign="top" width="86.87%" headers="mcps1.2.3.1.2 "><p id="p39406941"><a name="p39406941"></a><a name="p39406941"></a>ConflictStatus：请求新建数据已经存在。</p>
</td>
</tr>
<tr id="row19118157"><td class="cellrowborder" valign="top" width="13.13%" headers="mcps1.2.3.1.1 "><p id="p5066870"><a name="p5066870"></a><a name="p5066870"></a>429</p>
</td>
<td class="cellrowborder" valign="top" width="86.87%" headers="mcps1.2.3.1.2 "><p id="p7763324"><a name="p7763324"></a><a name="p7763324"></a>TooManyRequestsException：并发请求数太多。</p>
</td>
</tr>
<tr id="row2761053"><td class="cellrowborder" valign="top" width="13.13%" headers="mcps1.2.3.1.1 "><p id="p22318712"><a name="p22318712"></a><a name="p22318712"></a>500</p>
</td>
<td class="cellrowborder" valign="top" width="86.87%" headers="mcps1.2.3.1.2 "><p id="p62985252"><a name="p62985252"></a><a name="p62985252"></a>InternalServerError：服务内部出错。</p>
</td>
</tr>
</tbody>
</table>

